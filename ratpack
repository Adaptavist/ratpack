#!/usr/bin/env groovy
import groovy.lang.Binding
import groovy.util.GroovyScriptEngine
import com.bleedingwolf.ratpack.RatpackServlet
import com.bleedingwolf.ratpack.RatpackApp

def scriptFile = new File(args[0])

GroovyScriptEngine gse = new GroovyScriptEngine(scriptFile.parentFile.canonicalPath)
Binding binding = new Binding()

RatpackApp ratpack = new RatpackApp()
binding.setVariable('get', ratpack.get)
binding.setVariable('post', ratpack.post)
binding.setVariable('put', ratpack.put)
binding.setVariable('delete', ratpack.delete)
binding.setVariable('set', ratpack.set)

gse.run scriptFile.name, binding

RatpackServlet.serve(ratpack)