dependencies {
  groovy 'org.codehaus.groovy:groovy-all:2.1.0:indy'
  compile 'org.codehaus.groovy:groovy-all:2.1.0:indy'
  compile 'org.vert-x:vertx-core:1.3.0.final'
  compile 'com.google.guava:guava:13.0.1'
  compile 'com.google.inject:guice:3.0', {
    exclude group: 'org.sonatype.sisu.inject'
  }

  testCompile 'cglib:cglib-nodep:2.2'
  testCompile 'org.spockframework:spock-core:0.7-groovy-2.0', {
    exclude module: "groovy-all"
  }
}

// Workaround gradle bug with source and classifiers
configurations {
  groovySource
}
dependencies {
  groovySource 'org.codehaus.groovy:groovy-all:2.1.0:sources', { transitive = false }
}
idea.module.iml.whenMerged {
  def pathFactory = new org.gradle.plugins.ide.idea.model.PathFactory()
  def groovyJarPath = pathFactory.path(configurations.groovy.singleFile)
  def groovyLib = it.dependencies.find { it.classes.contains(groovyJarPath) }
  groovyLib.sources << pathFactory.path(configurations.groovySource.singleFile)
}