import org.apache.tools.ant.taskdefs.condition.Os
import org.gradle.api.tasks.Exec

apply plugin: 'ratpack-groovy'

buildscript {
	repositories {
		maven { url "https://oss.sonatype.org/content/repositories/snapshots/" }
		mavenCentral()
	}
	dependencies {
		classpath 'org.ratpack-framework.netty:ratpack-gradle:0.7.0-SNAPSHOT'
	}
}

repositories {
	maven { url "https://oss.sonatype.org/content/repositories/snapshots/" }
	mavenCentral()
	maven { url "http://repo.springsource.org/repo" } // for springloaded
}

task jshint(type: GruntTask) {
	gruntArgs = "jshint"
}

task watch(type: GruntTask) {
	gruntArgs = "watch"
}

task wrapper(type: Wrapper) {
	gradleVersion = '1.5'
}

class GruntTask extends Exec {
	private String gruntExecutable = Os.isFamily(Os.FAMILY_WINDOWS) ? "grunt.cmd" : "grunt"
	private String switches = "--no-color"

	String gruntArgs = ""

	public GruntTask() {
		super()
		this.setExecutable(gruntExecutable)
	}

	public void setGruntArgs(String gruntArgs) {
		this.args = "$switches $gruntArgs".trim().split(" ") as List
	}
}